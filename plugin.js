penpot.ui.open("Sticky Notes Plugin",`?theme=${penpot.theme}`);penpot.on("themechange",a=>{g({type:"theme",content:a})});function g(a){penpot.ui.sendMessage(a)}penpot.ui.onMessage(async a=>{if(a.type==="create-note"){const{content:p,includeNoteAuthor:r,noteTheme:d}=a.data,{currentUser:n}=penpot,i=d.backgroundColor??"#f0ff22",c=d.foregroundColor??"#000000";console.log(i,c);const e=penpot.createBoard();e.boardX=penpot.viewport.center.x,e.boardY=penpot.viewport.center.y,e.fills=[{fillOpacity:1,fillColor:i}],e.shadows=[{style:"drop-shadow",offsetX:4,offsetY:4,blur:4,color:{color:"#000000",opacity:.2}}],e.resize(300,300),e.name="üìù from "+n.name,e.borderRadius=8;const o=e.addFlexLayout();e.flex.dir="column",e.flex.alignItems="stretch",o.dir="column",o.alignItems="start",o.justifyContent="stretch",o.verticalPadding=16,o.horizontalPadding=16,o.horizontalSizing="fill",o.alignItems="stretch";const l=penpot.createText(p);if(l.growType="auto-width",l.fontSize="18",l.fills=[{fillOpacity:1,fillColor:c}],e.appendChild(l),l.layoutChild.horizontalSizing="fill",l.layoutChild.verticalSizing="fill",r){const t=penpot.createBoard();t.name="Footer",t.fills=[{fillOpacity:0,fillColor:"#f0ff22"}];const s=t.addFlexLayout();t.flex.dir="row",t.flex.horizontalSizing="fill",e.flex.justifyContent="stretch",s.alignItems="stretch",s.dir="row",s.justifyContent="space-between",s.topPadding=8,s.horizontalPadding=16;const f=penpot.createText(n.name??" ");f.resize(150,40),f.fills=[{fillOpacity:1,fillColor:c}],t.appendChild(f);const u=await penpot.uploadMediaData("avatar",y(n.avatarUrl),"image/png"),h=penpot.createRectangle();h.resize(40,40),h.fills=[{fillOpacity:1,fillImage:{...u,keepApectRatio:!0}}],t.appendChild(h),e.appendChild(t),t.layoutChild.horizontalSizing="fill",t.layoutChild.verticalSizing="auto"}}});function y(a){const p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=a.replace(/^data:image\/png;base64,/,"");let d=r.length,n=[];for(let i=0;i<d;i+=4){let c=p.indexOf(r[i]),e=p.indexOf(r[i+1]),o=p.indexOf(r[i+2]),l=p.indexOf(r[i+3]);if(isNaN(c)||isNaN(e))break;let t=c<<2|e>>4;if(n.push(t),!isNaN(o)){let s=e<<4&255|o>>2;if(n.push(s),!isNaN(l)){let f=o<<6&255|l;n.push(f)}}}return new Uint8Array(n)}
